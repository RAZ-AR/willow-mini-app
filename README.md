# Willow Coffee โ Telegram Mini App

![Status](https://img.shields.io/badge/Status-Production%20Ready-green) ![Frontend](https://img.shields.io/badge/Frontend-GitHub%20Pages-blue) ![Backend](https://img.shields.io/badge/Backend-Koyeb-purple) ![Database](https://img.shields.io/badge/Database-PostgreSQL-orange)

ะะพะปะฝะพััะฝะบัะธะพะฝะฐะปัะฝะพะต Telegram Mini App ะดะปั ะบะพัะตะนะฝะธ ั ัะธััะตะผะพะน ะทะฐะบะฐะทะพะฒ, ะฟัะพะณัะฐะผะผะพะน ะปะพัะปัะฝะพััะธ ะธ ะฐะดะผะธะฝ-ะฟะฐะฝะตะปัั.

## ๐๏ธ ะััะธัะตะบัััะฐ ัะธััะตะผั

```
โโโโโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโโโโ
โ   Telegram WebApp   โ    โ      Backend API     โ    โ   Admin Channel     โ
โ  (GitHub Pages)     โโโโโบโ      (Koyeb)         โโโโโบโ   (Telegram)        โ
โ                     โ    โ                      โ    โ                     โ
โ โข HTML/CSS/JS       โ    โ โข Express.js         โ    โ โข Order alerts      โ
โ โข Menu display      โ    โ โข PostgreSQL         โ    โ โข Admin commands    โ
โ โข Order form        โ    โ โข Telegram Bot API   โ    โ โข Real-time updates โ
โ โข Loyalty system    โ    โ โข CORS enabled       โ    โ                     โ
โโโโโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโโโโ
            โ                         โ
            โ                         โ
            โผ                         โผ
โโโโโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโโโโโ
โ   Google Sheets     โ    โ    PostgreSQL DB     โ
โ                     โ    โ                      โ
โ โข Dynamic menu      โ    โ โข Users & cards      โ
โ โข Multi-language    โ    โ โข Orders & items     โ
โ โข Easy updates      โ    โ โข Transactions       โ
โ โข CSV export        โ    โ โข Loyalty stars      โ
โโโโโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโโโโโ
```

## ๐ ะขะตะบััะตะต ัะพััะพัะฝะธะต

### โ ะะตะฐะปะธะทะพะฒะฐะฝะพ ะธ ัะฐะฑะพัะฐะตั:
- **Frontend**: ะะพะปะฝะพัััั ััะฝะบัะธะพะฝะฐะปัะฝัะน ะธะฝัะตััะตะนั ะฝะฐ GitHub Pages
- **Backend API**: Express.js ัะตัะฒะตั ะฝะฐ Koyeb ั ะฟะพะปะฝัะผ ััะฝะบัะธะพะฝะฐะปะพะผ
- **ะกะธััะตะผะฐ ะทะฐะบะฐะทะพะฒ**: ะกัะพะปะธะบะธ (1-10 + ะฝะฐ ะฒัะฝะพั), ETA (ัะตะนัะฐั/10ะผะธะฝ/20ะผะธะฝ), ัะฟะพัะพะฑั ะพะฟะปะฐัั (ะฝะฐะปะธัะฝัะต/ะทะฒะตะทะดั)  
- **ะะฐััะตั ะปะพัะปัะฝะพััะธ**: 1 ะทะฒะตะทะดะฐ ะทะฐ ะบะฐะถะดัะต 350 RSD
- **ะขะตััะพะฒัะน ัะตะถะธะผ**: ะะฐะฑะพัะฐะตั ะฑะตะท ะฝะฐัััะพะนะบะธ Telegram ะฑะพัะฐ
- **ะะธะฝะฐะผะธัะตัะบะพะต ะผะตะฝั**: ะะฐะณััะถะฐะตััั ะธะท Google Sheets
- **ะัะปััะธัะทััะฝะพััั**: EN/RU/SR

### โ๏ธ ะขัะตะฑัะตั ะฝะฐัััะพะนะบะธ ะดะปั ะฟัะพะดะฐะบัะตะฝะฐ:
- **BOT_TOKEN**: ะขะพะบะตะฝ Telegram ะฑะพัะฐ (ะพั @BotFather)
- **ADMIN_CHANNEL_ID**: ID ะบะฐะฝะฐะปะฐ ะดะปั ัะฒะตะดะพะผะปะตะฝะธะน ะพ ะทะฐะบะฐะทะฐั
- **DATABASE_URL**: PostgreSQL ะดะปั ะฟัะพะดะฐะบัะตะฝะฐ (ะพะฟัะธะพะฝะฐะปัะฝะพ)
- **Google Sheets**: ะกะดะตะปะฐัั ัะฐะฑะปะธัั ะฟัะฑะปะธัะฝะพะน

## ๐๏ธ ะขะตัะฝะพะปะพะณะธัะตัะบะธะน ััะตะบ

| ะะพะผะฟะพะฝะตะฝั | ะขะตัะฝะพะปะพะณะธั | ะฅะพััะธะฝะณ | ะกะพััะพัะฝะธะต |
|-----------|------------|---------|-----------|
| **Frontend** | HTML/CSS/JS + Telegram WebApp SDK | GitHub Pages | โ ะะพัะพะฒ |
| **Backend** | Express.js + Node.js | Koyeb | โ ะะฐะทะฒะตัะฝัั |
| **ะะฐะทะฐ ะดะฐะฝะฝัั** | PostgreSQL (prod) / Mock data (test) | Koyeb (ะฒัััะพะตะฝะฝะฐั) | โ ะะฐัััะพะตะฝะฐ |
| **ะะตะฝั** | Google Sheets CSV | Google Drive | โ๏ธ ะัะถะตะฝ ะฟัะฑะปะธัะฝัะน ะดะพัััะฟ |
| **ะะพั** | Telegram Bot API | - | โ๏ธ ะัะถะฝะฐ ะฝะฐัััะพะนะบะฐ |

## ๐ ะะพะทะผะพะถะฝะพััะธ ัะธััะตะผั

### ะะปั ะบะปะธะตะฝัะพะฒ:
- ๐ฝ๏ธ **ะัะพัะผะพัั ะผะตะฝั** ั ัะตะฝะฐะผะธ ะฝะฐ 3 ัะทัะบะฐั
- ๐ **ะะพัะทะธะฝะฐ ะทะฐะบะฐะทะพะฒ** ั ะฒัะฑะพัะพะผ ััะพะปะธะบะฐ ะธ ะฒัะตะผะตะฝะธ
- โญ **ะัะพะณัะฐะผะผะฐ ะปะพัะปัะฝะพััะธ** (1 ะทะฒะตะทะดะฐ = 350 RSD)
- ๐ **ะะฑะผะตะฝ ะทะฒะตะทะด** ะฝะฐ ะฝะฐะณัะฐะดั (ะบะพัะต, ะทะฐะฒััะฐะบ, etc.)
- ๐ณ **ะกะฟะพัะพะฑั ะพะฟะปะฐัั**: ะฝะฐะปะธัะฝัะต ะธะปะธ ะทะฒะตะทะดั
- ๐ฑ **Telegram ะธะฝัะตะณัะฐัะธั** ั ัะฒะตะดะพะผะปะตะฝะธัะผะธ

### ะะปั ะฐะดะผะธะฝะธัััะฐัะพัะพะฒ:
- ๐ข **ะะฒัะพะผะฐัะธัะตัะบะธะต ัะฒะตะดะพะผะปะตะฝะธั** ะพ ะฝะพะฒัั ะทะฐะบะฐะทะฐั
- ๐ **ะะตัะฐะปัะฝะฐั ะธะฝัะพัะผะฐัะธั**: ะบะปะธะตะฝั, ััะพะปะธะบ, ัะพััะฐะฒ ะทะฐะบะฐะทะฐ, ััะผะผะฐ
- โก **ะะดะผะธะฝ ะบะพะผะฐะฝะดั** ะฒ Telegram ะบะฐะฝะฐะปะต
- ๐ **ะะฑะฝะพะฒะปะตะฝะธะต ะผะตะฝั** ัะตัะตะท Google Sheets
- ๐ **ะฃะฟัะฐะฒะปะตะฝะธะต ะปะพัะปัะฝะพัััั** ะฟะพะปัะทะพะฒะฐัะตะปะตะน

## ๐ ะกััะปะบะธ

| ะะตัััั | URL | ะกัะฐััั |
|--------|-----|--------|
| **Frontend** | https://raz-ar.github.io/willow-mini-app/ | โ ะะบัะธะฒะตะฝ |
| **Backend API** | https://mild-lotta-willow-2025-1b544553.koyeb.app | โ ะะบัะธะฒะตะฝ |
| **Menu API** | https://mild-lotta-willow-2025-1b544553.koyeb.app/api/menu | โ ะะบัะธะฒะตะฝ |
| **Health Check** | https://mild-lotta-willow-2025-1b544553.koyeb.app/health | โ ะะบัะธะฒะตะฝ |
| **Google Sheets** | [Menu Table](https://docs.google.com/spreadsheets/d/1BRQuzea6bba0NxxPk9koLSzpHkfiAzrKmwDa8ow7128/) | โ๏ธ ะัะธะฒะฐัะฝะฐั |

## ๐ง API Endpoints

### ะัะฑะปะธัะฝัะต
```
GET  /health              - ะัะพะฒะตัะบะฐ ัะพััะพัะฝะธั ัะตัะฒะตัะฐ
GET  /api/menu            - ะะพะปััะตะฝะธะต ะผะตะฝั ะธะท Google Sheets
POST /api/user            - ะััะตะฝัะธัะธะบะฐัะธั/ัะพะทะดะฐะฝะธะต ะฟะพะปัะทะพะฒะฐัะตะปั  
POST /api/order           - ะกะพะทะดะฐะฝะธะต ะทะฐะบะฐะทะฐ
POST /api/redeem          - ะะฑะผะตะฝ ะทะฒะตะทะด ะฝะฐ ะฝะฐะณัะฐะดั
```

### Webhook
```
POST /tg/webhook          - Telegram Bot webhook
```

## ๐ ะัััััะน ะทะฐะฟััะบ

### ะขะตััะธัะพะฒะฐะฝะธะต (ะฑะตะท ะฝะฐัััะพะนะบะธ ะฑะพัะฐ):
1. ะัะบัะพะน https://raz-ar.github.io/willow-mini-app/
2. ะะพะฑะฐะฒั ัะพะฒะฐัั ะฒ ะบะพัะทะธะฝั
3. ะัะฑะตัะธ ััะพะปะธะบ ะธ ัะฟะพัะพะฑ ะพะฟะปะฐัั
4. ะัะพัะผะธ ะทะฐะบะฐะท

### ะะพะปะฝะฐั ะฝะฐัััะพะนะบะฐ:

#### 1. ะกะพะทะดะฐะน Telegram ะฑะพัะฐ
```bash
# ะะฐะฟะธัะธ @BotFather ะฒ Telegram
/newbot
# ะกะปะตะดัะน ะธะฝััััะบัะธัะผ, ะฟะพะปััะธ BOT_TOKEN
```

#### 2. ะะฐัััะพะน ะฟะตัะตะผะตะฝะฝัะต ะฒ Koyeb
ะะฐะนะดะธ ะฒ [ะฟะฐะฝะตะปั Koyeb](https://app.koyeb.com) โ ัะฒะพะน ัะตัะฒะธั โ Settings โ Environment:
```
BOT_TOKEN=1234567890:ABCdefGHIjklMNOpqrsTUVwxyz
ADMIN_CHANNEL_ID=-4988316360
DATABASE_URL=postgresql://... (ะพะฟัะธะพะฝะฐะปัะฝะพ ะดะปั ะฟัะพะดะฐะบัะตะฝะฐ)
```

#### 3. ะะฐัััะพะน Telegram ะฑะพัะฐ
```bash
# ะฃััะฐะฝะพะฒะธ webhook
curl "https://api.telegram.org/bot<BOT_TOKEN>/setWebhook?url=https://mild-lotta-willow-2025-1b544553.koyeb.app/tg/webhook"

# ะะฐัััะพะน WebApp
curl -X POST "https://api.telegram.org/bot<BOT_TOKEN>/setChatMenuButton" \
-H "Content-Type: application/json" \
-d '{
  "menu_button": {
    "type": "web_app",
    "text": "โ Willow Coffee", 
    "web_app": {"url": "https://raz-ar.github.io/willow-mini-app/"}
  }
}'
```

#### 4. ะะพะฑะฐะฒั ะฑะพัะฐ ะฒ ะฐะดะผะธะฝ-ะบะฐะฝะฐะป
1. ะะพะฑะฐะฒั ะฑะพัะฐ ะบะฐะบ ะฐะดะผะธะฝะธัััะฐัะพัะฐ ะฒ ะบะฐะฝะฐะป
2. ะะฐะน ะฟัะฐะฒะฐ ะฝะฐ ะพัะฟัะฐะฒะบั ัะพะพะฑัะตะฝะธะน

## ๐ ะกัััะบัััะฐ ะฑะฐะทั ะดะฐะฝะฝัั

```sql
-- ะะพะปัะทะพะฒะฐัะตะปะธ ะธ ะบะฐััั ะปะพัะปัะฝะพััะธ
users (telegram_id, first_name, last_name, username, stars, card_number, created_at)

-- ะะฐะบะฐะทั
orders (id, short_id, user_id, total_amount, stars_added, eta_minutes, due_at, status, created_at)

-- ะะพะทะธัะธะธ ะทะฐะบะฐะทะพะฒ  
order_items (id, order_id, item_id, quantity, unit_price, created_at)

-- ะขัะฐะฝะทะฐะบัะธะธ ะทะฒะตะทะด
transactions (id, user_id, type, stars_change, order_id, description, created_at)

-- ะะฐะณัะฐะดั ะฟัะพะณัะฐะผะผั ะปะพัะปัะฝะพััะธ
rewards (key, cost_stars, name_en, name_ru, name_sr, description, active)
```

## ๐ ะัะพัะตัั ะทะฐะบะฐะทะฐ

```mermaid
sequenceDiagram
    participant U as User
    participant F as Frontend
    participant B as Backend  
    participant T as Telegram
    participant A as Admin

    U->>F: ะัะบััะฒะฐะตั ะฟัะธะปะพะถะตะฝะธะต
    F->>B: GET /api/user (ะฐััะตะฝัะธัะธะบะฐัะธั)
    B->>F: ะะพะทะฒัะฐัะฐะตั ะดะฐะฝะฝัะต ะฟะพะปัะทะพะฒะฐัะตะปั
    
    U->>F: ะัะฑะธัะฐะตั ัะพะฒะฐัั
    U->>F: ะะฐะฟะพะปะฝัะตั ัะพัะผั ะทะฐะบะฐะทะฐ
    F->>B: POST /api/order
    
    B->>B: ะะฐะปะธะดะธััะตั ะดะฐะฝะฝัะต
    B->>B: ะกะพััะฐะฝัะตั ะฒ ะะ
    B->>B: ะะฐัะธัะปัะตั ะทะฒะตะทะดั
    B->>T: ะัะฟัะฐะฒะปัะตั ัะฒะตะดะพะผะปะตะฝะธะต ะฒ ะฐะดะผะธะฝ-ะบะฐะฝะฐะป
    T->>A: ะะพะบะฐะทัะฒะฐะตั ะบะฐััะพัะบั ะทะฐะบะฐะทะฐ
    
    B->>F: ะะพะทะฒัะฐัะฐะตั ะฟะพะดัะฒะตัะถะดะตะฝะธะต
    F->>U: ะะพะบะฐะทัะฒะฐะตั ััะฟะตัะฝะพะต ะพัะพัะผะปะตะฝะธะต
```

## ๐ ะัะปะฐะดะบะฐ ะธ ะปะพะณะธ

### ะัะพะฒะตัะบะฐ API:
```bash
# ะัะพะฒะตัะบะฐ ะทะดะพัะพะฒัั ัะตัะฒะตัะฐ
curl https://mild-lotta-willow-2025-1b544553.koyeb.app/health

# ะัะพะฒะตัะบะฐ ะผะตะฝั
curl https://mild-lotta-willow-2025-1b544553.koyeb.app/api/menu

# ะขะตััะพะฒัะน ะทะฐะบะฐะท
curl -X POST https://mild-lotta-willow-2025-1b544553.koyeb.app/api/order \
  -H "Content-Type: application/json" \
  -d '{
    "initData": "test",
    "items": [{"id": "item-234bbf05", "qty": 1}],
    "eta_minutes": 10,
    "table_number": "1",
    "payment_method": "cash"
  }'
```

### ะะพะณะธ Koyeb:
ะัะพะฒะตัั ะปะพะณะธ ะฒ ะฟะฐะฝะตะปะธ Koyeb โ ัะฒะพะน ัะตัะฒะธั โ Logs

## ๐ฎ ะะปะฐะฝั ัะฐะทะฒะธัะธั

### ะกะปะตะดัััะธะต ัะธัะธ:
- [ ] ะกัะฐัะธััะธะบะฐ ะทะฐะบะฐะทะพะฒ ะธ ะฐะฝะฐะปะธัะธะบะฐ
- [ ] ะกะธััะตะผะฐ ัะบะธะดะพะบ ะธ ะฟัะพะผะพะบะพะดะพะฒ  
- [ ] Push-ัะฒะตะดะพะผะปะตะฝะธั ะพ ะณะพัะพะฒะฝะพััะธ ะทะฐะบะฐะทะฐ
- [ ] ะะฝัะตะณัะฐัะธั ั ัะธััะตะผะฐะผะธ ะพะฟะปะฐัั
- [ ] ะะพะฑะธะปัะฝะพะต ะฟัะธะปะพะถะตะฝะธะต (React Native)
- [ ] ะกะธััะตะผะฐ ะพัะทัะฒะพะฒ ะธ ัะตะนัะธะฝะณะพะฒ
- [ ] ะฃะฟัะฐะฒะปะตะฝะธะต ะทะฐะฟะฐัะฐะผะธ ะธ ะพััะฐัะบะฐะผะธ

### ะขะตัะฝะธัะตัะบะธะต ัะปัััะตะฝะธั:
- [ ] ะะธะณัะฐัะธั ะฝะฐ TypeScript
- [ ] Unit ะธ ะธะฝัะตะณัะฐัะธะพะฝะฝัะต ัะตััั
- [ ] CI/CD pipeline
- [ ] Monitoring ะธ alerting
- [ ] Backup ะธ disaster recovery
- [ ] Load balancing ะดะปั ะฒััะพะบะธั ะฝะฐะณััะทะพะบ

## ๐ฅ ะฃัะฐััะฝะธะบะธ ะฟัะพะตะบัะฐ

- **ะััะธัะตะบัััะฐ ะธ ัะฐะทัะฐะฑะพัะบะฐ**: Claude Code AI
- **ะัะพะดัะบัะพะฒัะต ััะตะฑะพะฒะฐะฝะธั**: ะะปะฐะดะตะปะตั ะบะพัะตะนะฝะธ
- **ะะธะทะฐะนะฝ**: ะะธะฝะธะผะฐะปะธััะธัะฝัะน UI ะฒ ััะธะปะต Telegram

## ๐ ะะธัะตะฝะทะธั

ะัะพะตะบั ัะฐะทัะฐะฑะพัะฐะฝ ะดะปั ัะฐััะฝะพะณะพ ะธัะฟะพะปัะทะพะฒะฐะฝะธั ะบะพัะตะนะฝะธ Willow Coffee.

---

**๐ ะะตะฟะพะทะธัะพัะธะน**: https://github.com/RAZ-AR/willow-mini-app  
**๐ฑ ะัะธะปะพะถะตะฝะธะต**: https://raz-ar.github.io/willow-mini-app/  
**โก API**: https://mild-lotta-willow-2025-1b544553.koyeb.app

*ะะพัะปะตะดะฝะตะต ะพะฑะฝะพะฒะปะตะฝะธะต: 29 ะฐะฒะณัััะฐ 2025*